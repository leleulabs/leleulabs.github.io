/*
 # -----------------------------------------------------------------------------
 # ~/assets/theme/j1/modules/videojs/js/plugins/players/wt/wistia.min.js
 # Provides Wistia Playback Technology (Tech) for Video.js V8 and newer
 # See: https://github.com/edly-io/videojs-wistia
 #
 #  Product/Info:
 #  http://jekyll.one
 #
 # Copyright (C) 2020-2021 Zia Fazal
 # Copyright (C) 2021 Edly by Arbisoft
 # Copyright (C) 2023-2025 Juergen Adams
 #
 #  videojs-wistia is licensed under MIT License.
 #  See: https://github.com/edly-io/videojs-wistia/blob/master/LICENSE
 #  J1 Theme is licensed under MIT License.
 #  See: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE
 # -----------------------------------------------------------------------------
*/

!function(e,t){if("object"==typeof exports&&"undefined"!=typeof module){var i=require("video.js");module.exports=t(i.default||i)}else"function"==typeof define&&define.amd?define(["videojs"],(function(i){return e.Wistia=t(i)})):e.Wistia=t(e.videojs)}(this,(function(e){"use strict";const t="development"===j1.env||"dev"===j1.env;var i,s,a,o=log4javascript.getLogger("videoJS.plugin.wistia"),r=e.browser.IS_IOS||e.browser.IS_NATIVE_ANDROID,n=e.getTech("Tech");class l extends n{constructor(e,t){super(e,t),this.setPoster(e.poster),this.setSrc(this.options_.source,!0);var i=document.getElementById(e.playerId);i.classList.remove("vjs-controls-disabled"),i.classList.add("vjs-controls-enabled"),i.classList.remove("vjs-user-inactive"),i.classList.add("vjs-user-active"),this.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-wistia",r&&(this.el_.parentNode.className+=" vjs-wistia-mobile"),l.isApiReady?this.initWistiaPlayer():l.apiReadyQueue.push(this))}.bind(this))}dispose(){if(this.wistiaPlayer)this.wistiaPlayer&&(this.wistiaPlayer.pause(),this.wistiaPlayer.remove());else{var e=l.apiReadyQueue.indexOf(this);-1!==e&&l.apiReadyQueue.splice(e,1)}this.wistiaPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-wistia","").replace(" vjs-wistia-mobile",""),this.el_.parentNode.removeChild(this.el_)}createEl(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("style","position:absolute;width:100%;height:100%;top:0;left:0"),e.setAttribute("class","vjs-tech "+this.options_.playback_css_class);var t=document.createElement("div");return t.appendChild(e),t}initWistiaPlayer(){var e={controlsVisibleOnLoad:!1,chromeless:!0,playbar:!1,playButton:!1,settingsControl:!1,smallPlayButton:!1,volumeControl:!1,videoFoam:!1,fullscreenButton:!1,preload:!0,doNotTrack:!0,autoPlay:!1};void 0!==this.options_.videoFoam&&(e.videoFoam=this.options_.videoFoam),void 0!==this.options_.source&&(this.videoId=this.options_.source.src),void 0!==this.options_.autoplay&&(e.autoPlay=this.options_.autoplay,e.muted=this.options_.autoplay);var i=this;window._wq=window._wq||[],_wq.push({id:this.videoId,options:e,onReady:e=>{i.wistiaPlayer=e,i.onPlayerReady(i.options_),i.wistiaPlayer.bind("end",i.onPlaybackEnded.bind(i))}}),t&&o.debug("\ncreated "+this.name_+" player on ID: "+this.el_.firstChild.id)}onPlayerReady(e){for(var s=e.poster,a=e.techId,r=document.getElementById(a),n=(document.getElementsByClassName("w-vulcan-v2"),document.getElementsByClassName("vjs-poster")),l=0;l<n.length;l++)n[l].style.cursor="default";""!==s?r.addEventListener("click",(e=>{i=this.wistiaPlayer.state(),t&&o.debug("\nwt player state: "+i)})):r.addEventListener("click",(e=>{i=this.wistiaPlayer.state(),t&&o.debug("\nwt player state: "+i),"beforeplay"===i&&(this.wistiaPlayer.play(),this.trigger("play"),t&&o.debug("\ntriggered play on state: "+i))})),this.options_.muted&&this.wistiaPlayer.mute(),this.playerReady_=!0,this.triggerReady(),this.playOnReady&&this.play()}onPlaybackEnded(){this.trigger("ended")}src(e){return this.setSrc({src:e}),this.source}setSrc(e){e&&e.src&&(delete this.errorName,this.source=e,this.options_.autoplay&&!r&&(this.isReady_?this.play():this.playOnReady=!0))}setPoster(e){this.poster_=e}autoplay(){return this.options_.autoplay}setAutoplay(e){this.options_.autoplay=e}loop(){return this.options_.loop}setLoop(e){this.options_.loop=e}play(){this.videoId&&(this.isReady_?(this.wistiaPlayer.play(),this.trigger("play")):(this.trigger("waiting"),this.playOnReady=!0))}pause(){this.wistiaPlayer.pause(),this.trigger("pause")}paused(){return"paused"===this.wistiaPlayer.state()||"ended"===this.wistiaPlayer.state()}currentTime(){return this.wistiaPlayer.time()}setCurrentTime(e){this.wistiaPlayer.time(e)}duration(){return this.wistiaPlayer.duration()}currentSrc(){return this.source&&this.source.src}ended(){return"ended"===this.wistiaPlayer.state()}volume(){return this.wistiaPlayer.volume()}setVolume(e){this.wistiaPlayer.volume(e),this.trigger("volumechange")}muted(){return this.wistiaPlayer.isMuted()}setMuted(e){!0===e?this.wistiaPlayer.mute():this.wistiaPlayer.unmute(),this.trigger("volumechange")}supportsFullScreen(){return!0}}function d(){l.isApiReady=!0,t&&o.debug("\nAPI loaded successfully");for(var e=0;e<l.apiReadyQueue.length;++e)l.apiReadyQueue[e].initWistiaPlayer();t&&o.debug("\nadded players to ready queue: #"+e),a=Date.now(),t&&o.debug("\ninitializing plugin: finished"),t&&o.debug("\nplugin initializing time: "+(a-s)+"ms")}l.isSupported=()=>!0,l.canPlaySource=e=>l.canPlayType(e.type),l.canPlayType=e=>"video/wistia"===e,l.apiReadyQueue=[];var u=setInterval((()=>{var i="block"===$("#content").css("display");"finished"===j1.getState()&&i&&(s=Date.now(),t&&o.debug("\ninitializing plugin: started"),t&&o.debug("\nversion of videoJS detected: "+e.VERSION),function(e,t){var i=!1,s=document.createElement("script"),a=document.getElementsByTagName("script")[0];a&&(a.parentNode.insertBefore(s,a),s.onload=()=>{i||(i=!0,t())},s.onreadystatechange=()=>{i||"complete"!==this.readyState&&"loaded"!==this.readyState||(i=!0,t())},s.src=e)}("//fast.wistia.com/assets/external/E-v1.js",d),function(){const e="\n        .vjs-wistia-mobile .vjs-big-play-button { display: none; }\n      ";var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e)),t&&o.debug("\nadded additional CSS styles"),i.appendChild(s)}(),clearInterval(u))}),10);void 0!==e.registerTech?e.registerTech("Wistia",l):console.error("\ninvalid version of videoJS detected: "+e.VERSION)}));
