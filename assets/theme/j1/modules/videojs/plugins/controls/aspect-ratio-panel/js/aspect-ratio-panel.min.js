/*! @name @yangkghjh/videojs-aspect-ratio-panel @version 0.0.1 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self).videojsAspectRatioPanel=t(e.videojs)}(this,function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var n=(e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e).getComponent("MenuButton"),s=function(s){function r(e,t){var r;return r=s.call(this,e,{name:"ResizerButton"})||this,n.apply(i(r),arguments),r.controlText(e.localize("Aspect Ratio")),r}t(r,s);var o=r.prototype;return o.createEl=function(){return e.dom.createEl("div",{className:"vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},o.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},o.update=function(){return n.prototype.update.call(this)},o.handleClick=function(){this.player().getChild("ResizerPanel").toggleClass("vjs-hidden")},r}(n),r=e.getComponent("Component"),o=function(n){function s(e,t){var s;s=n.call(this,e,t)||this,r.apply(i(s),arguments),s.aspectRadio="origin",s.percent=100,s.radioWidth=1,s.radioHeight=1,s.currentHeight=s.player().currentHeight(),s.currentWidth=s.player().currentWidth();var o=s.el();o.childNodes[1].childNodes[1].onclick=function(){s.toggleClass("vjs-hidden")},window.addEventListener("resize",function(){s.currentHeight==s.player().currentHeight()&&s.currentWidth==s.player().currentWidth()||(s.currentHeight=s.player().currentHeight(),s.currentWidth=s.player().currentWidth(),s.resize())}),o.onmouseup=function(){o.onmousemove=null};var l=o.childNodes[1].childNodes[5].childNodes[1].childNodes[3];s.setScrollFunc(o,l,function(e){s.setPercent(e)}),s.player().on("play",function(){s.resize()});for(var a=o.childNodes[1].childNodes[5].childNodes[3].childNodes,d=[a[1],a[5],a[9],a[13]],c="origin",h=0;h<d.length;h++)d[h].onchange=function(e){e.target.value!==c&&(c=e.target.value,s.setAspectRadio(e.target.value))};return o.childNodes[1].childNodes[5].childNodes[5].childNodes[1].onclick=function(e){d[0].checked=!0,s.reset()},s}t(s,n);var o=s.prototype;return o.setAspectRadio=function(e){switch(e){case"origin":this.aspectRadio="origin";break;case"fill":this.aspectRadio="fill";break;case"16:9":this.aspectRadio="16:9",this.radioWidth=16,this.radioHeight=9;break;case"4:3":this.aspectRadio="4:3",this.radioWidth=4,this.radioHeight=3}this.resize()},o.setPercent=function(e){this.percent=e,this.resize()},o.reset=function(){this.player().tech_.el().style.objectFit="contain",this.aspectRadio="origin",this.percent=100;var e=this.el().childNodes[1].childNodes[5].childNodes[1].childNodes[3];e.childNodes[1].style.left="255px",e.childNodes[3].style.width="255px",this.resize()},o.resize=function(){if("origin"!=this.aspectRadio?this.player().tech_.el().style.objectFit="fill":this.player().tech_.el().style.objectFit="contain","origin"!=this.aspectRadio&&"fill"!=this.aspectRadio){var e=this.currentWidth/this.currentHeight,t=this.currentWidth,i=t*this.radioHeight/this.radioWidth;e>this.radioWidth/this.radioHeight&&(t=(i=this.currentHeight)*this.radioWidth/this.radioHeight);var n=(this.currentWidth-t*this.percent/100)/2,s=(this.currentHeight-i*this.percent/100)/2;this.setPadding(n,s)}else{var r=this.currentWidth*(100-this.percent)/100/2,o=this.currentHeight*(100-this.percent)/100/2;this.setPadding(r,o)}},o.setPadding=function(e,t){e<0&&(e=0),this.player().tech_.el().style.paddingLeft=e+"px",this.player().tech_.el().style.paddingRight=e+"px",t<0&&(t=0),this.player().tech_.el().style.paddingTop=t+"px",this.player().tech_.el().style.paddingBottom=t+"px"},o.setScrollFunc=function(e,t,i){var n=t.childNodes[1],s=t.childNodes[3],r=0;n.onmousedown=function(t){var n=(t||window.event).clientX-this.offsetLeft,o=this;e.onmousemove=function(e){var t=e||window.event;(r=t.clientX-n)<0?r=0:r>255&&(r=255),s.style.width=r+"px",o.style.left=r+"px",i(parseInt(r/255*100)),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}}},o.createEl=function(){return e.dom.createEl("div",{className:"vjs-resizer-modal vjs-hidden",innerHTML:'\n        <div class="vjs-resizer-modal-content">\n        <span class="vjs-resizer-modal-close">&times;</span>\n          <div class="vjs-resizer-modal-title">Aspect Ratio</div>\n          <div class="vjs-resizer-wrap">\n            <div class="vjs-resizer-size">\n              <span class="size-title">Size</span>\n              <div class="size-scroll" id="size-scroll">\n                <div class="size-scroll-bar"></div>\n                <div class="size-scroll-mask"></div>\n              </div>\n            </div>\n            <div class="radios">\n              Ratio\n              <input type="radio" name="radio" id="origin" value="origin" checked >\n              <label for="origin">Default</label>\n              <input type="radio" name="radio" id="4:3" value="4:3">\n              <label for="4:3">4:3</label>\n              <input type="radio" name="radio" id="16:9" value="16:9">\n              <label for="16:9">16:9</label>\n              <input type="radio" name="radio" id="fill" value="fill">\n              <label for="fill">Full</label>\n            </div>\n            <ul style="clear:both">\n                <li id="vjs-resizer-reset">Reset</li>\n            </ul>\n          </div>\n        </div>\n        '})},s}(r),l=e.getPlugin("plugin"),a={},d=function(i){function n(t,n){var r;return(r=i.call(this,t)||this).options=e.mergeOptions(a,n),r.player.ready(function(){if(r.player.addClass("vjs-aspect-ratio-panel"),"Html5"!=t.techName_)return!1;t.on(["loadedmetadata"],function(e){if("undefined"==t.aspect_ratio_initialized||1==t.aspect_ratio_initialized);else{t.aspect_ratio_initialized=!0;var i=t.controlBar,n=i.getChild("fullscreenToggle").el();i.el().insertBefore(i.addChild("ResizerButton").el(),n),t.addChild("ResizerPanel")}})}),e.registerComponent("ResizerButton",s),e.registerComponent("ResizerPanel",o),r}return t(n,i),n}(l);return d.defaultState={},d.VERSION="0.0.1",e.registerPlugin("aspectRatioPanel",d),d});
