/*
 # -----------------------------------------------------------------------------
 # ~/assets/theme/j1/modules/cookieConsent/js/cookieConsent.min.js
 # Provides JS Core for J1 Module BS Cookie Consent
 #
 #  Product/Info:
 #  https://shaack.com
 #  http://jekyll.one
 #
 #  Copyright (C) 2020 Stefan Haack
 #  Copyright (C) 2023-2025 Juergen Adams
 #
 #  bootstrap-cookie-banner is licensed under MIT License.
 #  See: https://github.com/shaack/bootstrap-cookie-banner/blob/master/LICENSE
 #  J1 Theme is licensed under MIT License.
 #  See: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE
 # -----------------------------------------------------------------------------
 # TODO:
 #
 # -----------------------------------------------------------------------------
 # NOTE:
 #  BS Cookie Consent is a MODIFIED version of bootstrap-cookie-banner
 #  for the use with J1 Theme. This modified version cannot be used
 #  outside of J1 Theme!
 # -----------------------------------------------------------------------------
*/

"use strict";function CookieConsent(o){var e,t=log4javascript.getLogger("j1.api.CookieConsent"),i=this,n=!1,a=!!new liteURL(window.location.href).protocol.includes("https"),s=navigator.language||navigator.userLanguage;for(var l in t.debug("initializing core module: started"),t.debug("state: started"),-1!==s.indexOf("-")&&(s=s.split("-")[0]),this.props={autoShowDialog:!0,dialogLanguage:"en",dialogLanguages:["en","de"],contentURL:"/assets/data/cookieconsent",postSelectionCallback:"",whitelisted:[],xhrDataElement:"consent-data",dialogContainerID:"consent-modal"},o)this.props[l]=o[l];-1!==this.props.dialogLanguage.indexOf("-")&&(this.props.dialogLanguage=this.props.dialogLanguage.split("-")[0]),this.props.dialogLanguages.includes(this.props.dialogLanguage)||(this.props.dialogLanguage="en"),this.props.xhrDataElement=this.props.xhrDataElement+"-"+this.props.dialogLanguage,this.props.cookieSecure=a;var r={set:(o,e,t,i,n,a)=>{var s=window.btoa(e),l="; expires=Thu, 01 Jan 1970 00:00:00 UTC";if(t>0){var r=new Date;r.setTime(r.getTime()+24*t*60*60*1e3),l="; expires="+r.toUTCString()}document.cookie=a?n?o+"="+(s||"")+l+"; Path=/; SameSite="+i+"; Domain="+n+"; Secure="+a+";":o+"="+(s||"")+l+"; Path=/; SameSite="+i+"; Secure="+a+";":n?o+"="+(s||"")+l+"; Path=/; SameSite="+i+";Domain="+n+"; ":o+"="+(s||"")+l+"; Path=/; SameSite="+i+";"},get:o=>{for(var e=o+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var n=t[i];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e)){var a=n.substring(e.length,n.length);return window.atob(a)}}}},d=function(o){"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o)};function c(o){d(function(){if(i.modal=document.getElementById(i.props.dialogContainerID),i.modal)i.$modal.modal("show");else{t.info("load consent modal"),i.modal=document.createElement("div"),i.modal.id=i.props.dialogContainerID,i.modal.style.display="none",i.modal.setAttribute("class","modal fade"),i.modal.setAttribute("tabindex","-1"),i.modal.setAttribute("role","dialog"),i.modal.setAttribute("aria-labelledby",i.props.dialogContainerID),document.body.append(i.modal),i.$modal=$(i.modal),i.$modal.on("show.bs.modal",(function(){})),i.$modal.on("hidden.bs.modal",(function(){!function(o,e){for(var t=Array.prototype.slice.call(arguments,2),i=o.split("."),n=i.pop(),a=0;a<i.length;a++)e=e[i[a]];e[n].apply(e,t)}(i.props.postSelectionCallback,window)}));var o=i.props.contentURL+"/index.html";$.get(o).done((function(o){t.info("loading consent modal: successfully"),i.modal.innerHTML=o,i.modal.innerHTML=$("#"+i.props.xhrDataElement).eq(0).html(),i.modal.style.display="block",$(i.modal).modal({backdrop:"static",keyboard:!1}),i.$buttonDoNotAgree=$("#bccs-buttonDoNotAgree"),i.$buttonAgree=$("#bccs-buttonAgree"),i.$buttonSave=$("#bccs-buttonSave"),i.$buttonAgreeAll=$("#bccs-buttonAgreeAll"),t.info("load/initialze options from cookie"),g(),p(),$("#bccs-options").on("hide.bs.collapse",(function(){n=!1,g()})).on("show.bs.collapse",(function(){n=!0,g()})),t.info("initialze event handler"),i.$buttonDoNotAgree.click((function(){r.set(i.props.cookieName,JSON.stringify(u(!1)),0,i.props.cookieSameSite,i.props.cookieDomain,a),i.$modal.modal("hide"),window.location.href="/445.html"})),i.$buttonAgree.click((function(){m()})),i.$buttonSave.click((function(){$("#bccs-options").collapse("hide"),r.set(i.props.cookieName,JSON.stringify(u()),i.props.cookieStorageDays,i.props.cookieSameSite,i.props.cookieDomain,a),i.$modal.modal("hide"),p()})),i.$buttonAgreeAll.click((function(){$("#bccs-options").collapse("hide"),m(),p()})),i.$modal.modal("show")})).fail((function(){t.error("loading consent modal: failed"),t.warn("probably no `contentURL` set")}))}}.bind(this))}function p(){var o=i.getSettings();if(o)for(var e in o){i.$modal.find("#bccs-options .bccs-option[data-name='"+e+"'] input[type='checkbox']").prop("checked",o[e])}}function g(){n?(i.$buttonDoNotAgree.hide(),i.$buttonAgree.hide(),i.$buttonSave.show(),i.$buttonAgreeAll.show()):(i.$buttonDoNotAgree.show(),i.$buttonAgree.show(),i.$buttonSave.hide(),i.$buttonAgreeAll.hide())}function u(o){for(var e=i.$modal.find("#bccs-options .bccs-option"),t={},n=0;n<e.length;n++){var a=e[n],s=a.getAttribute("data-name");if("necessary"===s)t[s]=!0;else if(void 0===o){var l=$(a).find("input[type='checkbox']");t[s]=l.prop("checked")}else t[s]=!!o}return t}function m(){r.set(i.props.cookieName,JSON.stringify(u(!0)),i.props.cookieStorageDays,i.props.cookieSameSite,i.props.cookieDomain,a),i.$modal.modal("hide")}e=this.props.whitelisted.indexOf(window.location.pathname)>-1;var h=r.get(this.props.cookieName);void 0!==h&&"false"!==h||!this.props.autoShowDialog||e||c(),t.debug("initializing core module finished"),t.debug("state: finished"),this.showDialog=function(){(e=this.props.whitelisted.indexOf(window.location.pathname)>-1)||c()},this.getSettings=function(o){if(r.get(i.props.cookieName)){var e=JSON.parse(r.get(i.props.cookieName));return void 0===o?e:!!e&&e[o]}}}

