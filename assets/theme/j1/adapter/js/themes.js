/*
 # -----------------------------------------------------------------------------
 # ~/assets/theme/j1/adapter/js/themes.js
 # JS Adapter for J1 themes (ThemeSwitcher)
 #
 # Product/Info:
 # https://jekyll.one
 # https://github.com/jguadagno/ThemeSwitcher
 #
 # Copyright (C) 2023-2025 Juergen Adams
 # Copyright (C) 2014 Joseph Guadagno
 #
 # J1 Template is licensed under the MIT License.
 # For details, see: https://github.com/jekyll-one-org/j1-template/blob/main/LICENSE
 # ThemeSwitcher is licensed under the MIT License.
 # For details, see https://github.com/jguadagno/ThemeSwitcher/blob/master/LICENSE
 # -----------------------------------------------------------------------------
 # NOTE:
 #  Setup of theme loaders for local_themes|remote_themes moved
 #  to adapter navigator.js
 # -----------------------------------------------------------------------------
 # Adapter generated: 2025-07-14 03:21:09 +0200
 # -----------------------------------------------------------------------------
*/
"use strict";j1.adapter.themes=function(e,t){function o(e){var t=document.styleSheets;t[t.length-1];for(var o in document.styleSheets)if(t[o].href&&t[o].href.indexOf(e)>-1)return!0;return!1}"development"===e.env||e.env;var s,i,a,n,r,c,l,d,h,m,u=!!'production'.includes('dev'),f=!!(r=new liteURL(t.location.href)).protocol.includes('https'),p={},_=e.getCookieNames(),g='default',k=u?'.css':'.min.css',w='UnoLight',b='J1 Team',v='https://jekyll.one/',C='/assets/theme/j1/core/css/themes/'+w.toLowerCase()+'/bootstrap'+k,x=0,S=function(e,t){if(!$.isFunction(t))throw Error('Not a valid callback');$.ajax({type:'HEAD',url:e,success:$.proxy(t,this,!0),error:$.proxy(t,this,!1)})};return{init:function(d){$.extend({module_name:'j1.adapter.themes',generated:'2025-07-14 03:21:09 +0200'},d);c=e.adapter.themes,l=log4javascript.getLogger('j1.adapter.themes'),i=$.extend({},{enabled:!1,debug:!1,saveToCookie:!0,reloadPageOnChange:!1,retries:30,preview_page:"/pages/public/tools/previewer/current_theme/",menu_icon_family:"mdib",menu_icon_color:"var(--md-gray-500)",menu_icon_size:"mdib-sm",cssThemeLink:"bootstrapTheme",defaultCssFile:"https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css",bootswatchApiUrl:"https://bootswatch.com/api",bootswatchApiVersion:5,loadFromBootswatch:!0,localThemes:"/assets/data/themes.json",excludeBootswatch:"Default, default, Lux, Sketchy",includeBootswatch:null,skipIncludeBootswatch:null}),a=$.extend({},{enabled:!0}),n=$.extend(!0,{},i,a),n.retries,r=new liteURL(t.location.href),r.origin,r.origin+'/204.html',e.findCookie('j1'),e.findCookie('__g');var u=setInterval(()=>{var t='block'===$('#content').css("display"),o='finished'===e.getState();if(t&&o){if(h=Date.now(),p=e.readCookie(_.user_state),e.readCookie(_.user_consent),c.setState('started'),l.debug('state: '+c.getState()),l.info('module is being initialized'),l.info('hide page until theme is loaded'),$('#no_flicker').hide(),l.info('cookie '+_.user_state+' successfully loaded after: '+25*x+' ms'),''===p.theme_css&&(p.theme_name=w,p.theme_css=C,p.theme_author=b,p.theme_author_url=v,e.writeCookie({name:_.user_state,data:p,secure:f,expires:365})||l.error('failed to write cookie: '+_.user_consent)),p.theme_switcher=n.enabled,n.enabled){l.info('themes detected as: '+n.enabled),l.info('remote themes are being initialized');var i=`${n.bootswatchApiUrl}/${n.bootswatchApiVersion}.json`;S(i,function(e){e?(l.debug('LOAD remote themes from: '+i),$('#remote_themes').ThemeSwitcher.defaults={debug:n.debug,saveToCookie:n.saveToCookie,cssThemeLink:n.cssThemeLink,cookieThemeName:n.cookieThemeName,cookieDefaultThemeName:n.cookieDefaultThemeName,cookieThemeCss:n.cookieThemeCss,cookieThemeExtensionCss:n.cookieThemeExtensionCss,cookieExpiration:n.cookieExpiration,cookiePath:n.cookiePath,defaultCssFile:n.defaultCssFile,bootswatchApiUrl:n.bootswatchApiUrl,bootswatchApiVersion:n.bootswatchApiVersion,loadFromBootswatch:n.loadFromBootswatch,localFeed:n.localThemes,excludeBootswatch:n.excludeBootswatch,includeBootswatch:n.includeBootswatch,skipIncludeBootswatch:n.skipIncludeBootswatch}):l.error('failed to LOAD remote themes from: '+i)})}S(p.theme_css,function(t){if(t)var o=setInterval(function(){'finished'==e.getState()&&(s='<link rel="stylesheet" id="'+g+'" href="'+p.theme_css+'" type="text/css">',$('head').append(s),clearInterval(o))},10);else l.warn('themes CSS invalid: '+p.theme_css),s='<link rel="stylesheet" id="'+g+'" href="'+C+'" type="text/css">',l.debug('set default theme :'+w),l.debug('theme CSS loaded: '+C),$('head').append(s),p.theme_name=w,p.theme_css=C,p.theme_author=b,p.theme_author_url=v,e.writeCookie({name:_.user_state,data:p,secure:f,expires:365})||l.error('failed to write cookie: '+_.user_consent),location.reload(!0)}),clearInterval(u)}},10),k=setInterval(()=>{p=e.readCookie(_.user_state),o(p.theme_css)&&(l.info('theme loaded successfully: '+p.theme_name),l.debug('theme CSS loaded: '+p.theme_css),l.info('show page on theme loaded'),$('#no_flicker').show(),c.setState('finished'),l.debug('state: '+c.getState()),l.info('initializing module finished'),m=Date.now(),l.info('module initializing time: '+(m-h)+'ms'),clearInterval(k))},10)},messageHandler:(e,t)=>{var o=JSON.stringify(t,undefined,2);return d='received message from '+e+': '+o,l.debug(d),'command'===t.type&&'module_initialized'===t.action&&l.info(t.text),!0},setState:e=>{c.state=e},getState:()=>c.state}}(j1,window);