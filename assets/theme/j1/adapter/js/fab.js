/*
 # -----------------------------------------------------------------------------
 # ~/assets/theme/j1/adapter/js/fab.js
 # JS Adapter for J1 FABs (Floating Action Buttons)
 #
 # Product/Info:
 # http://jekyll.one
 #
 # Copyright (C) 2023-2025 Juergen Adams
 #
 # J1 Template is licensed under the MIT License.
 # For details, see http://jekyll.one
 # -----------------------------------------------------------------------------
 # TODO: check why 'found toc in page: disabled' detected (some times)
 #       if a toc IS configured
 # -----------------------------------------------------------------------------
 # Adapter generated: 2025-09-27 03:33:52 +0200
 # -----------------------------------------------------------------------------
*/
"use strict";j1.adapter.fab=((e,o)=>{"development"===e.env||e.env;var t,n,i,a,l,r,d,c,s,_;e.api.isMobile(),e.getCookieNames();return{init:o=>{$.extend({module_name:'j1.adapter.fab',generated:'2025-09-27 03:33:52 +0200'},o);r=e.adapter.fab,d=log4javascript.getLogger('j1.adapter.fab'),l=$('[class$="sect1"],[class$="sect2"],[class$="sect3"]'),$('[class$="sect1"],[class$="sect2"]'),$('[class$="sect1"]'),a=null!=o?$.extend({},o):{},t=$.extend({},{enabled:!1,mode:"icon",xhr_container_id:"fab-container",xhr_data_path:"/assets/data/fab/index.html",icon_family:"mdib",icon_color:"md-grey",icon_size:"mdib-2x",raised:5,pulsed:!1,menu_options:{direction:"top",hoverEnabled:!1,toolbarEnabled:!1}}),n=$.extend({},{enabled:!0,menu_options:{hoverEnabled:!0},menus:[{name:"Scroll to top",enabled:!0,id:"default",icon:"chevron-double-up",icon_family:"mdib",icon_color:"md-gray-900",icon_hover:"chevron-double-up",color:"primary",items:[{item:null,enabled:!0,event_handler:"scroll_to_top"}]},{name:"Top and Reload",enabled:!0,id:"top-reload",icon:"plus",icon_family:"mdib",icon_color:"md-gray-900",icon_hover:"chevron-up",color:"primary",items:[{item:"To Top",enabled:!0,id:"fam_scroll_to_top",color:"md-green",event_handler:"scroll_to_top",icon:"chevron-double-up",icon_properties:null},{item:"Reload Page",enabled:!0,id:"fam_reload_page",color:"md-red",event_handler:"reload_page",icon:"reload",icon_properties:null}]},{name:"Open TOC",enabled:!0,id:"open_toc",icon:"plus",icon_family:"mdib",icon_color:"md-gray-900",icon_hover:"chevron-up",color:"primary",items:[{item:"To Top",enabled:!0,id:"fam_scroll_to_top",color:"md-green",event_handler:"scroll_to_top",icon:"chevron-double-up",icon_properties:null},{item:"Table of Contents",enabled:!0,id:"open_mmenu_toc",color:"md-green",event_handler:"open_mmenu_toc",icon:"wrap",icon_properties:null}]},{name:"Open TOC Reload",enabled:!0,id:"open_toc_reload",icon:"plus",icon_family:"mdib",icon_color:"md-gray-900",icon_hover:"chevron-up",color:"primary",items:[{item:"To Top",enabled:!0,id:"fam_scroll_to_top",color:"md-green",event_handler:"scroll_to_top",icon:"chevron-double-up",icon_properties:null},{item:"Reload Page",enabled:!0,id:"fam_reload_page",color:"md-red",event_handler:"reload_page",icon:"reload",icon_properties:null},{item:"Table of Contents",enabled:!0,id:"open_mmenu_toc",color:"md-green",event_handler:"open_mmenu_toc",icon:"wrap",icon_properties:null}]},{name:"page control",enabled:!0,id:"page_ctrl",icon:"plus",icon_family:"mdib",icon_color:"md-gray-900",icon_hover:"chevron-up",color:"primary",items:[{item:"To Top",enabled:!0,id:"fam_scroll_to_top",color:"md-green",event_handler:"scroll_to_top",icon:"chevron-double-up",icon_properties:null},{item:"Previous Section",enabled:!0,id:"fam_previous_section",color:"md-green",event_handler:"scroll_previous_section",icon:"step-backward",icon_properties:"mdib-rotate-90"},{item:"Next Section",enabled:!0,id:"fam_next_section",color:"md-green",event_handler:"scroll_next_section",icon:"step-forward",icon_properties:"mdib-rotate-90"},{item:"Reload Page",enabled:!0,id:"fam_reload_page",color:"md-red",event_handler:"reload_page",icon:"reload",icon_properties:null},{item:"Table of Contents",enabled:!0,id:"open_mmenu_toc",color:"md-green",event_handler:"open_mmenu_toc",icon:"wrap",icon_properties:null}]}]}),i=$.extend(!0,{},t,n,a),r.moduleOptions=i;var c=setInterval(()=>{var o='block'===$('#content').css("display"),t='finished'===e.getState();o&&t&&(s=Date.now(),r.setState('started'),d.info('set module state to: '+r.getState()),d.info('module is being initialized'),d.info('load FABs'),r.fabLoader(i),clearInterval(c))},10)},fabLoader:o=>{r.setState('loading'),d.info('set module state to: '+r.getState()),d.info('load HTML data for FAB: '+o.fab_menu_id),e.loadHTML({xhr_container_id:o.xhr_container_id,xhr_data_path:o.xhr_data_path,xhr_data_element:o.fab_menu_id},'j1.adapter.fab','data_loaded');var t=setInterval(()=>{'success'===e.xhrDOMState['#'+o.xhr_container_id]&&(r.setState('loaded'),d.info('set module state to: '+r.getState()),d.info('HTML data for FAB: '+r.getState()),r.buttonInitializer(o),$('.fab-btn').show(),r.setState('finished'),d.debug('state: '+r.getState()),d.info('module initialized successfully'),_=Date.now(),d.info('module initializing time: '+(_-s)+'ms'),clearInterval(t))},10)},buttonInitializer:o=>{var t,n,i,a,c,s,_,m=$('#'+o.xhr_container_id),p=o.icon_family.toLowerCase(),f=o.menu_options,h=document.querySelectorAll('.fab-btn');1===h.length?(r.setState('processing'),d.info('set module state to: '+r.getState()),d.info('initialize FAB menu'),a=h[0].firstElementChild.id,n=a.replace('_button',''),e.fab.init(h,f),c=$('#'+a),o.menus.forEach((e,t)=>{e.id===n&&(i=o.menus[t])}),_=i.items.length,s=p+'-'+i.icon+' '+p+'-'+i.icon_hover,f.hoverEnabled?c.hover(function(){$('#fab-icon').toggleClass(s)},function(){$('#fab-icon').toggleClass(s)}):c.on('click',()=>{$('#fab-icon').toggleClass(s)}),_>1?i.items.forEach(o=>{if($('#'+o.id).length)if(1==(t=o.event_handler).split(' ').length){if(d.debug('register pre-configured eventhandler '+t+' on id: #'+o.id),'open_mmenu_toc'===t)if($('#j1-toc-mgr').length){d.info('found toc in page: enabled');var n=setInterval(()=>{'finished'==e.adapter.toccer.getState()&&(d.debug('met dependencies for: toccer'),$('#open_mmenu_toc').show(),clearInterval(n))},10)}else d.info('found toc in page: disabled');else $('#'+o.id).show();$('#'+o.id).each(function(){$(this).on('click',function(){r[o.event_handler](l)})})}else d.info('register custom eventhandler on id: #'+o.id);else d.error('creating Eventhandler failed on id: #'+o.id)}):(d.info('single action found for FAB, no menu loaded/created'),i.items.forEach(o=>{if(1===(t=o.event_handler).split(' ').length&&(d.debug('register pre-configured eventhandler '+t+' on id: #'+a),'scroll_to_top'===t&&c.on('click',function(){var e=0;$('html, body').animate({scrollTop:e},500)}),'open_mmenu_toc'===t))if($('#j1-toc-mgr').length){d.info('found toc in page: enabled');var n=setInterval(()=>{'finished'===e.adapter.toccer.getState()&&(d.debug('met dependencies for toccer: finished'),c.prop('id','open_mmenu_toc'),clearInterval(n))},10)}else d.info('found toc in page: disabled'),d.info('eventhandler: disabled')}))):(d.error('multiple FAB buttons found: '+h.length),d.info('FAB container set to hidden: '+m),m.hide())},open_mmenu_toc:()=>{},reload_page:()=>{location.reload(!0)},scroll_previous_section:t=>{var n,i,a,l=0,r=$(t).length-1,d=$('#sidebar').find('.is-active-link').attr('href'),c=300,s=0,_=$('.attic'),m=$('nav.navbar'),p=$('#adblock'),f=m.hasClass('navbar-fixed')?'fixed':'scrolled',h=$('body').css('font-size').replace('px',''),u=(o.pageYOffset,parseInt(h)),g=_.length?_.height():0,b=m.length?m.height():0,v=p.length?p.height():0,x='fixed'==f?-1*(b+v+u):-1*(g+b+v+u);x+=s,t.each(()=>{if($(this).find(d).length){if(l>r)return!1;i=l>0?t[l-1]:t[l],n=$(i).find(':header').first()[0].id,a='#'+n,e.api.scrollSmooth.scroll(a,{duration:c,offset:x,callback:null})}l<r&&l++})},scroll_next_section:t=>{var n,i,a,l,r=0,d=$(t).length-1,c=$('#sidebar'),s=300,_=0;n=c.find('.is-active-link').attr('href'),t.each(()=>{if($(this).find(n).length){if(r==d)return!1;i=t[r+1],a=$(i).find(':header').first()[0].id,l='#'+a;var c=$('.attic'),m=$('nav.navbar'),p=$('#adblock'),f=m.hasClass('navbar-fixed')?'fixed':'scrolled',h=$('body').css('font-size').replace('px',''),u=(o.pageYOffset,parseInt(h)),g=c.length?c.height():0,b=m.length?m.height():0,v=p.length?p.height():0,x='fixed'==f?-1*(b+v+u):-1*(g+b+v+u);x+=_,e.api.scrollSmooth.scroll(l,{duration:s,offset:x,callback:null})}r<d&&r++})},scroll_to_top:()=>{var e=0;$('html, body').animate({scrollTop:e},500)},scroll_to_bottom:()=>{var e=$(document),o=$('#j1_footer'),t=o.length?o.outerHeight():0,n=e.height()-t-400;e.outerHeight();$('html, body').animate({scrollTop:n},500)},scroll_to_comments:()=>{},alert_me:()=>{alert('Hello world!')},messageHandler:(e,o)=>{var t=JSON.stringify(o,undefined,2);return c='received message from '+e+': '+t,d.debug(c),'command'===o.type&&'module_initialized'===o.action&&d.info(o.text),!0},setState:e=>{r.state=e},getState:()=>r.state}})(j1,window);